# 📘 Phase 2.0 – DB Integration and Semantic Orchestration

---

## 🎯 Goal

Establish a robust, queryable backend for loop, insight, and roadmap tracking — integrating a structured database (SQLite) and vector memory (Qdrant if applicable). Enable all semantic orchestration logic to run atop persistent, testable data.

---

## 🧱 Scope

### 🗃 SQLite Layer
- Define `loop.db` schema with:
  - `loops`: id, title, score, created, feedback_score, roadmap_id, tags, archived
  - `insights`: id, loop_id, content, tags, feedback, created
  - `feedback`: loop_id, tag, timestamp
  - `roadmap_items`: id, title, status, summary
- Add connection interface: `loop_registry.py`
- Migrate `vault_index.json` to SQLite-backed abstraction

---

### 🔍 Qdrant Integration (Optional)
- Define vector schema for `loop_embeddings`
- Populate via `loop_memory.py` and `embedder.py`
- Enable semantic search + related loop recommendations

---

### ⚙ Persistence Rewrites
- Update `status_writer.py` to write into `loop.db`
- Route insight saves to both markdown and DB

---

### 🧠 Semantic Routing (Post-DB)
- Use `roadmap_id` to auto-link loops/insights to roadmap entries
- Allow filtering, scoring, promotion from DB queries

---

## ✅ Completion Criteria

- `loop.db` present and populated from vault
- JSON-based indexing deprecated
- All new insights/logs registered via DB interface
- Optional: Qdrant search endpoint returns loop matches


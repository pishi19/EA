"use strict";(()=>{var e={};e.id=495,e.ids=[495],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},2048:e=>{e.exports=require("fs")},629:e=>{e.exports=require("fs/promises")},5315:e=>{e.exports=require("path")},2906:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>S,patchFetch:()=>j,requestAsyncStorage:()=>P,routeModule:()=>y,serverHooks:()=>E,staticGenerationAsyncStorage:()=>w});var s={};t.r(s),t.d(s,{GET:()=>v});var o=t(9303),a=t(8716),i=t(3131),n=t(7070),u=t(629),l=t.n(u),p=t(5315),d=t.n(p),c=t(3673),m=t.n(c),g=t(6314);let f=d().resolve(process.cwd(),"../../.."),h=d().join(f,"runtime","loops"),x=["## Purpose","## âœ… Objectives","## \uD83D\uDD27 Tasks","## \uD83E\uDDFE Execution Log","## \uD83E\uDDE0 Memory Trace"];async function k(e){try{let r,t,s,o;let a=await l().readFile(e,"utf-8"),{data:i,content:n}=m()(a,g.G);if(!i||!i.uuid)return[];let u=function(e){let r=[],t=[];for(let s of x){let o=RegExp(`^${s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}`,"gm"),a=e.match(o);0===(a?a.length:0)&&(t.push(s),r.push(`Missing required section: "${s}"`))}return{isValid:0===r.length,missingRequiredSections:t,errors:r}}(n);u.isValid||console.warn(`Schema validation failed for ${e}:`,u.errors);let p=/```json:memory\n([\s\S]*?)\n```/g,d=[];for(;null!==(r=p.exec(n));)try{d.push(JSON.parse(r[1]))}catch(r){console.error(`Failed to parse memory trace JSON in ${e}:`,r)}let c=/Task promoted from GPT suggestion: "(.*?)" \(GPT-suggested\)/g,f=new Set;for(;null!==(t=c.exec(n));)f.add(t[1]);let h=/Task promoted from workstream_plan.md: "(.*?)" by ora/g,k=new Set;for(;null!==(s=h.exec(n));)k.add(s[1]);let v=n.match(/## (?:ðŸ”§ )?Tasks\n\n([\s\S]*?)(?=\n## |$)/),y=v?v[1]:"",P=/-\s\[( |x)\]\s(.*)/g,w=[],E=0;if(y)for(;null!==(o=P.exec(y));){let e=o[2].trim(),r=d.filter(r=>r.description===e);w.push({id:`${i.uuid}-task-${E++}`,description:e,is_complete:"x"===o[1].trim(),source_loop:{uuid:i.uuid,title:i.title||"Untitled Loop",phase:i.phase||"N/A",workstream:i.workstream||"unassigned",tags:i.tags||[],validation:u},memory_traces:r.length>0?r:void 0,origin:f.has(e)?"gpt":k.has(e)?"plan":void 0})}return w}catch(r){return console.error(`Error parsing file ${e}:`,r),[]}}async function v(){try{let e=(await l().readdir(h)).filter(e=>e.endsWith(".md")),r=[];for(let t of e){let e=d().join(h,t),s=await k(e);r=r.concat(s)}return n.NextResponse.json(r)}catch(r){console.error("Failed to get tasks:",r);let e=r instanceof Error?r.message:"Internal Server Error";return n.NextResponse.json({message:"Failed to get tasks",error:e},{status:500})}}let y=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/tasks/route",pathname:"/api/tasks",filename:"route",bundlePath:"app/api/tasks/route"},resolvedPagePath:"/Users/air/Projects/ora-system/src/ui/react-app/app/api/tasks/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:P,staticGenerationAsyncStorage:w,serverHooks:E}=y,S="/api/tasks/route";function j(){return(0,i.patchFetch)({serverHooks:E,staticGenerationAsyncStorage:w})}},6314:(e,r,t)=>{t.d(r,{G:()=>o});var s=t(3366);let o={engines:{yaml:{parse:e=>s.ZP.load(e,{schema:s.ZP.JSON_SCHEMA}),stringify:e=>s.ZP.dump(e)}}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972,673,366],()=>t(2906));module.exports=s})();
"use strict";(()=>{var e={};e.id=320,e.ids=[320],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},2048:e=>{e.exports=require("fs")},629:e=>{e.exports=require("fs/promises")},5315:e=>{e.exports=require("path")},8019:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>O,patchFetch:()=>k,requestAsyncStorage:()=>_,routeModule:()=>R,serverHooks:()=>x,staticGenerationAsyncStorage:()=>v});var a={};t.r(a),t.d(a,{GET:()=>A});var o=t(9303),s=t(8716),n=t(3131),i=t(7070),p=t(629),l=t.n(p),u=t(5315),c=t.n(u),d=t(3366),m=t(3673),h=t.n(m),f=t(6716),g=t(6314);let P=function(){let e=process.cwd();for(;e!==c().dirname(e);){try{let r=t(2048),a=c().join(e,"runtime");return r.accessSync(a),e}catch{}try{let r=t(2048),a=c().join(e,"package.json"),o=r.readFileSync(a,"utf-8"),s=JSON.parse(o);if("ora-system"===s.name)return e}catch{}e=c().dirname(e)}return console.warn("Could not find project root, falling back to relative path"),c().resolve(process.cwd(),"../../..")}(),y={PROJECT_ROOT:P,RUNTIME_DIR:c().join(P,"runtime"),LOOPS_DIR:c().join(P,"runtime","loops"),PHASES_DIR:c().join(P,"runtime","phases"),WORKSTREAMS_DIR:c().join(P,"runtime","workstreams"),PLAN_PATH:c().join(P,"runtime","workstreams","roadmap","workstream_plan.md"),BACKUP_DIR:c().join(P,"runtime","backups"),ROADMAP_YAML_PATH:c().join(P,"runtime","system_roadmap.yaml")};async function w(e,r){try{if(!e||"string"!=typeof e||""===e.trim())return console.warn(`Invalid loop ID: ${e}`),null;let t=c().join(y.LOOPS_DIR,e),a=await l().readFile(t,"utf-8"),{data:o,content:s}=h()(a,g.G);return{id:o.id||e,title:o.title||o.name||e.replace(".md",""),phase:parseFloat(o.phase)||r,status:o.status||"unknown",workstream:o.workstream||"unassigned",score:o.score||0,tags:o.tags||[],summary:o.summary||"",content:await (0,f.TU)(s),created:o.created||"",type:o.type||"execution"}}catch(r){return console.error(`Error processing loop ${e}:`,r),null}}async function S(e){let r=(e.loops||[]).filter(e=>e&&e.id).map(r=>w(r.id,e.phase)),t=(await Promise.allSettled(r)).filter(e=>"fulfilled"===e.status&&null!==e.value).map(e=>e.value),a="";try{let r=c().join(y.PHASES_DIR,`phase-${e.phase}.md`),t=await l().readFile(r,"utf-8"),{content:o}=h()(t,g.G);a=await (0,f.TU)(o)}catch(r){console.debug(`Phase content not found for phase ${e.phase}`)}return{...e,content:a,loops:t}}async function j(e){try{let r=await l().readdir(y.LOOPS_DIR),t=[];for(let a of r)if(a.endsWith(".md"))try{let r=c().join(y.LOOPS_DIR,a),o=await l().readFile(r,"utf-8"),{data:s}=h()(o,g.G);s.phase&&parseFloat(s.phase)===e&&t.push(a)}catch(e){console.debug(`Skipping loop file ${a}:`,e);continue}return t}catch(e){return console.error("Error scanning loop files:",e),[]}}async function A(){try{let e=await l().readFile(y.ROADMAP_YAML_PATH,"utf-8"),r=d.ZP.load(e),t=(await Promise.all(r.phases.map(async e=>{let r=[];return r=e.loops&&e.loops.length>0?e.loops.filter(e=>null!=e&&void 0!==e&&""!==String(e).trim()).map(r=>({id:String(r),title:String(r).replace(".md",""),phase:e.phase})):(await j(e.phase)).map(r=>({id:r,title:r.replace(".md",""),phase:e.phase})),{...e,loops:r}}))).map(S),a=await Promise.all(t);return a.sort((e,r)=>e.phase-r.phase),i.NextResponse.json(a)}catch(r){console.error("Failed to get roadmap data:",r);let e=r instanceof Error?r.message:"Internal Server Error";return i.NextResponse.json({message:"Failed to get roadmap data",error:e},{status:500})}}let R=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/roadmap/route",pathname:"/api/roadmap",filename:"route",bundlePath:"app/api/roadmap/route"},resolvedPagePath:"/Users/air/Projects/ora-system/src/ui/react-app/app/api/roadmap/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:_,staticGenerationAsyncStorage:v,serverHooks:x}=R,O="/api/roadmap/route";function k(){return(0,n.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:v})}},6314:(e,r,t)=>{t.d(r,{G:()=>o});var a=t(3366);let o={engines:{yaml:{parse:e=>a.ZP.load(e,{schema:a.ZP.JSON_SCHEMA}),stringify:e=>a.ZP.dump(e)}}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[276,972,673,366,716],()=>t(8019));module.exports=a})();
"use strict";(()=>{var e={};e.id=657,e.ids=[657],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},2048:e=>{e.exports=require("fs")},629:e=>{e.exports=require("fs/promises")},5315:e=>{e.exports=require("path")},5599:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>P,patchFetch:()=>y,requestAsyncStorage:()=>h,routeModule:()=>x,serverHooks:()=>v,staticGenerationAsyncStorage:()=>f});var r={};s.r(r),s.d(r,{POST:()=>g});var o=s(9303),n=s(8716),a=s(3131),u=s(7070),i=s(629),p=s.n(i),d=s(5315),l=s.n(d),m=s(3673),c=s.n(m);async function g(e){let{loopId:t}=await e.json();if(!t)return u.NextResponse.json({message:"Missing loopId"},{status:400});try{let e=l().resolve(process.cwd(),"..","..","..","runtime","loops",`${t}.md`),s=await p().readFile(e,"utf-8"),{data:r,content:o}=c()(s),n="",a=o.match(/## ðŸ§  Memory Trace\n\n([\s\S]*?)(?=\n## |$)/);if(a)n=a[1];else{let e=o.match(/## Context\n\n([\s\S]*?)(?=\n## |$)/);if(e)n=e[1];else{let e=o.match(/## Purpose\n\n([\s\S]*?)(?=\n## |$)/);e&&(n=e[1])}}let i=r.summary||"",d=`What task should be added next based on these memory traces and this loop context?

Summary:
${i}

Context:
${n}`;return console.log("Generated Prompt:",d),u.NextResponse.json({suggestion:"Based on the summary and context, a good next task would be to \"Implement the 'Promote to Task' feature\"."})}catch(s){console.error(`Failed to get suggestion for loop ${t}:`,s);let e=s instanceof Error?s.message:"Internal Server Error";return u.NextResponse.json({message:"Failed to get suggestion",error:e},{status:500})}}let x=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/suggest-next-step/route",pathname:"/api/suggest-next-step",filename:"route",bundlePath:"app/api/suggest-next-step/route"},resolvedPagePath:"/Users/air/Projects/ora-system/src/ui/react-app/app/api/suggest-next-step/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:h,staticGenerationAsyncStorage:f,serverHooks:v}=x,P="/api/suggest-next-step/route";function y(){return(0,a.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:f})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,972,673],()=>s(5599));module.exports=r})();
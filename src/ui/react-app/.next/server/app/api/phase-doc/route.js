"use strict";(()=>{var e={};e.id=954,e.ids=[954],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},2048:e=>{e.exports=require("fs")},629:e=>{e.exports=require("fs/promises")},5315:e=>{e.exports=require("path")},8241:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>q,requestAsyncStorage:()=>x,routeModule:()=>w,serverHooks:()=>j,staticGenerationAsyncStorage:()=>v});var a={};r.r(a),r.d(a,{GET:()=>g});var s=r(9303),o=r(8716),n=r(3131),i=r(7070),p=r(629),d=r.n(p),u=r(5315),c=r.n(u),l=r(3673),h=r.n(l),f=r(6716);async function m(e){let t=await d().readFile(e,"utf-8"),{data:r,content:a}=h()(t);return{metadata:r,content:a}}async function g(e){try{let{searchParams:t}=new URL(e.url),r=t.get("phase"),a=c().resolve(process.cwd(),"..","..","..","runtime","phases"),s=c().resolve(process.cwd(),"..","..","..","runtime","loops"),o=await d().readdir(a),n=[];for(let e of o)if(e.endsWith(".md")&&e.startsWith("phase-"))try{let t=c().join(a,e),{metadata:r}=await m(t);r.phase&&n.push(r)}catch(t){console.error(`Failed to parse phase file ${e}:`,t)}n.sort((e,t)=>t.phase-e.phase);let p=null;if((p=r?n.find(e=>String(e.phase)===r):n.find(e=>"in_progress"===e.status))||(p=n.length>0?n[0]:null),!p)return i.NextResponse.json({message:"No phases found"},{status:404});let u=c().join(a,`phase-${p.phase}.md`),{content:l}=await m(u),h=await (0,f.TU)(l),g=await d().readdir(s),w=[],x=new Set;for(let e of g)if(e.endsWith(".md")){let t=c().join(s,e),{metadata:r,content:a}=await m(t);String(r.phase)===String(p.phase)&&(w.push({...r,content:await (0,f.TU)(a)}),r.tags&&Array.isArray(r.tags)&&r.tags.forEach(e=>x.add(e)))}return w.sort((e,t)=>new Date(t.created).getTime()-new Date(e.created).getTime()),i.NextResponse.json({activePhase:p,activePhaseContent:h,phaseLoops:w,allPhases:n.map(e=>e.phase),allTags:Array.from(x)})}catch(t){console.error("Failed to get phase doc data:",t);let e=t instanceof Error?t.message:"Internal Server Error";return i.NextResponse.json({message:"Failed to get phase doc data",error:e},{status:500})}}let w=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/phase-doc/route",pathname:"/api/phase-doc",filename:"route",bundlePath:"app/api/phase-doc/route"},resolvedPagePath:"/Users/air/Projects/ora-system/src/ui/react-app/app/api/phase-doc/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:x,staticGenerationAsyncStorage:v,serverHooks:j}=w,y="/api/phase-doc/route";function q(){return(0,n.patchFetch)({serverHooks:j,staticGenerationAsyncStorage:v})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,972,673,716],()=>r(8241));module.exports=a})();